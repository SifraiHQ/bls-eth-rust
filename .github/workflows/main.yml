name: test
on: [push]

jobs:
  #  build:
  #    name: test
  #    runs-on: ubuntu-latest
  #    steps:
  #    - uses: actions/checkout@v2
  #    - run: wget https://github.com/herumi/bls-eth-go-binary/raw/master/bls/lib/linux/amd64/libbls384_256.a
  #    - run: env RUSTFLAGS="-L./" cargo test --verbose
  windows:
    name: Build on Windows
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v2
      with:
        submodules: true
    - name: Building MCL for Windows
      run: |
        call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\VC\Auxiliary\Build\vcvars64.bat"
        cd D:\a\sifraihq\windows\mcl && call mklib.bat dll
      shell: cmd
    - run: cd bls; ls eth; cd ../bls-eth-rust; mkdir bls/eth; set RUSTFLAGS="-L../bls/lib" cargo test --target x86_64-pc-windows-msvc --verbose
      
